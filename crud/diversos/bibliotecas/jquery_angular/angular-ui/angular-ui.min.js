/**
 * AngularUI - The companion suite for AngularJS
 * @version v0.4.0 - 2013-04-18
 * @link http://angular-ui.github.com
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("ui.config",[]).value("ui.config",{}),angular.module("ui.filters",["ui.config"]),angular.module("ui.directives",["ui.config"]),angular.module("ui",["ui.filters","ui.directives","ui.config"]),angular.module("ui.directives").directive("uiDate",["ui.config",function(e){"use strict";var t;return t={},angular.isObject(e.date)&&angular.extend(t,e.date),{require:"?ngModel",link:function(t,n,r,i){var s=function(){return angular.extend({},e.date,t.$eval(r.uiDate))},o=function(){var e=s();if(i){var r=function(){t.$apply(function(){var e=n.datepicker("getDate");n.datepicker("setDate",n.val()),i.$setViewValue(e),n.blur()})};if(e.onSelect){var o=e.onSelect;e.onSelect=function(e,n){r(),t.$apply(function(){o(e,n)})}}else e.onSelect=r;n.bind("change",r),i.$render=function(){var e=i.$viewValue;if(angular.isDefined(e)&&e!==null&&!angular.isDate(e))throw new Error("ng-Model value must be a Date object - currently it is a "+typeof e+" - use ui-datejs to convert it from a string");n.datepicker("setDate",e)}}n.datepicker("destroy"),n.datepicker(e),i&&i.$render()};t.$watch(s,o,!0)}}}]).directive("uiDateFormat",["ui.config",function(e){var t={require:"ngModel",link:function(t,n,r,i){var s=r.uiDateFormat||e.dateFormat;s?(i.$formatters.push(function(e){if(angular.isString(e))return $.datepicker.parseDate(s,e)}),i.$parsers.push(function(e){if(e)return $.datepicker.formatDate(s,e)})):(i.$formatters.push(function(e){if(angular.isString(e))return new Date(e)}),i.$parsers.push(function(e){if(e)return e.toISOString()}))}};return t}]),angular.module("ui.directives").directive("uiMask",[function(){var e={9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/};return{priority:100,require:"ngModel",restrict:"A",link:function(t,n,r,i){function b(e){if(!angular.isDefined(e))return w();A(e);if(!s)return w();E(),S()}function w(){return s=!1,x(),angular.isDefined(p)?n.attr("placeholder",p):n.removeAttr("placeholder"),angular.isDefined(d)?n.attr("maxlength",d):n.removeAttr("maxlength"),n.val(i.$modelValue),i.$viewValue=i.$modelValue,!1}function E(){l=m=k(i.$modelValue||""),c=v=L(l),h=C(l),viewValue=h&&l.length?c:"",r.maxlength&&n.attr("maxlength",u[u.length-1]*2),n.attr("placeholder",f),n.val(viewValue),i.$viewValue=viewValue}function S(){if(o)return!0;n.bind("blur",O),n.bind("mousedown mouseup",_),n.bind("input keyup click",D),o=!0}function x(){if(!o)return!0;n.unbind("blur",O),n.unbind("mousedown",_),n.unbind("mouseup",_),n.unbind("input",D),n.unbind("keyup",D),n.unbind("click",D),o=!1}function T(e){return s?(l=k(e||""),h=C(l),i.$setValidity("mask",h),h?L(l):undefined):e}function N(e){return s?(l=k(e||""),h=C(l),viewValue=l.length?L(l):"",i.$viewValue=viewValue,i.$setValidity("mask",h),l===""&&i.$error.required!==undefined&&i.$setValidity("required",!1),h?l:undefined):e}function C(e){return e.length?e.length===u.length-1:!0}function k(e){var t="",n=a.slice();return angular.forEach(e.toString().split(""),function(e,r){n.length&&n[0].test(e)&&(t+=e,n.shift())}),t}function L(e){var t="",n=u.slice();return angular.forEach(f.split(""),function(r,i){e.length&&i===n[0]?(t+=e.charAt(0)||"_",e=e.substr(1),n.shift()):t+=r}),t}function A(t){var n=0;u=[],a=[],f="",t instanceof Array?angular.forEach(t,function(e,t){e instanceof RegExp?(u.push(n++),f+="_",a.push(e)):typeof e=="string"&&angular.forEach(e.split(""),function(e,t){f+=e,n++})}):typeof t=="string"&&angular.forEach(t.split(""),function(t,r){e[t]?(u.push(n),f+="_",a.push(e[t])):f+=t,n++}),u.push(u.slice().pop()+1),s=u.length>1?!0:!1}function O(e){g=0,y=0;if(!h||l.length===0)c="",n.val(""),t.$apply(function(){i.$setViewValue("")})}function M(e){y=j(this),n.unbind("mouseout",M)}function _(e){e.type==="mousedown"?n.bind("mouseout",M):n.unbind("mouseout",M)}function D(e){e=e||{which:0,type:"input"};var r=e.which,s=e.type;if(r==16||r==91)return!0;var o=n,a=o.val(),l=v,c,h=k(a),p=m,d=!1,b=H(this)||0,w=g||0,E=b-w,S=u[0],x=u[h.length]||u.slice().shift(),T=j(this),N=y||0,C=T>0,A=N>0,O=a.length>l.length||N&&a.length>l.length-N,M=a.length<l.length||N&&a.length==l.length-N,_=r>=37&&r<=40&&e.shiftKey,D=r==37,F=r==8||s!="keyup"&&M&&E===-1,I=r==46||s!="keyup"&&M&&E===0&&!A,q=(D||F||s=="click")&&b>S;y=T;if(_||C&&(s=="click"||s=="keyup"))return!0;if((s=="input"||s=="propertychange")&&M&&!A&&h===p){while(F&&b>0&&!P(b))b--;while(I&&b<f.length&&u.indexOf(b)==-1)b++;var R=u.indexOf(b);h=h.substring(0,R)+h.substring(R+1),d=!0}c=L(h),v=c,m=h,o.val(c),d&&t.$apply(function(){i.$setViewValue(h)}),O&&b<=S&&(b=S+1),q&&b--,b=b>x?x:b<S?S:b;while(!P(b)&&b>S&&b<x)b+=q?-1:1;(q&&b<x||O&&!P(w))&&b++,g=b,B(this,b)}function P(e){return u.indexOf(e)>-1}function H(e){if(e.selectionStart!==undefined)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();return t.moveStart("character",-e.value.length),t.text.length}}function B(e,t){if(e.offsetWidth===0||e.offsetHeight===0)return!0;if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}function j(e){if(e.selectionStart!==undefined)return e.selectionEnd-e.selectionStart;if(document.selection)return document.selection.createRange().text.length}var s=!1,o=!1,u,a,f,l,c,h,p=r.placeholder,d=r.maxlength,v,m,g,y;r.$observe("uiMask",b),i.$formatters.push(T),i.$parsers.push(N),n.bind("mousedown mouseup",_),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:r!==0&&r!==Infinity&&r!==-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1})}}}]);